!function(){if("undefined"==typeof document)return"transform";for(var t=["oTransform","msTransform","mozTransform","webkitTransform","transform"],i=document.createElement("div").style,e=0;e<t.length;e++)if(t[e]in i)return t[e]}();var t="undefined"!=typeof window&&window.devicePixelRatio||1,i=Object.create(null);function e(e,n){if("function"==typeof e.render){var s=e.render();if(s instanceof HTMLCanvasElement)return e.width=s.width,e.height=s.height,s}var r=document.createElement("canvas"),h=r.getContext("2d"),a=e.style||{};a.font=a.font||"10px sans-serif",a.textBaseline=a.textBaseline||"bottom";var o=1*a.lineWidth;for(var d in o=o>0&&o!==1/0?Math.ceil(o):1*!!a.strokeStyle,h.font=a.font,e.width=e.width||Math.max(1,Math.ceil(h.measureText(e.text).width)+2*o),e.height=e.height||Math.ceil(function(t,e){if(i[t])return i[t];var n=12,s=t.match(/(\d+(?:\.\d+)?)(px|%|em|rem)(?:\s*\/\s*(\d+(?:\.\d+)?)(px|%|em|rem)?)?/);if(s){var r=1*s[1]||10,h=s[2],a=1*s[3]||1.2,o=s[4];"%"===h&&(r*=e.container/100),"em"===h&&(r*=e.container),"rem"===h&&(r*=e.root),"px"===o&&(n=a),"%"===o&&(n=r*a/100),"em"===o&&(n=r*a),"rem"===o&&(n=e.root*a),void 0===o&&(n=r*a)}return i[t]=n,n}(a.font,n))+2*o,r.width=e.width*t,r.height=e.height*t,h.scale(t,t),a)h[d]=a[d];var u=0;switch(a.textBaseline){case"top":case"hanging":u=o;break;case"middle":u=e.height>>1;break;default:u=e.height-o}return a.strokeStyle&&h.strokeText(e.text,o,u),h.fillText(e.text,o,u),r}function n(t){return 1*window.getComputedStyle(t,null).getPropertyValue("font-size").match(/(.+)px/)[1]}var s={name:"canvas",init:function(t){var i=document.createElement("canvas");return i.context=i.getContext("2d"),i._fontSize={root:n(document.getElementsByTagName("html")[0]),container:n(t)},i},clear:function(t,i){t.context.clearRect(0,0,t.width,t.height);for(var e=0;e<i.length;e++)i[e].canvas=null},resize:function(i,e,n){i.width=e*t,i.height=n*t,i.style.width=e+"px",i.style.height=n+"px"},framing:function(t){t.context.clearRect(0,0,t.width,t.height)},setup:function(t,i){for(var n=0;n<i.length;n++){var s=i[n];s.canvas=e(s,t._fontSize)}},render:function(i,e){i.context.drawImage(e.canvas,e.x*t,e.y*t)},remove:function(t,i){i.canvas=null}};function r(t){const i=this,e=i.media?i.media.currentTime:Date.now()/1e3,n=i.media?i.media.playbackRate:1,s=t.mode,r=t.height,h=i._.height,a=Math.floor(h/r);i._.space[s]&&i._.space[s].length===a||(i._.space[s]=new Array(a).fill(null).map(()=>({time:0,width:0,height:0})));const o=i._.space[s];let d=-1;function u(t,i,e,n,s,r){if(!t||!t.time)return!0;var h=e-t.time,a=r._.duration/n;if("top"===s||"bottom"===s)return h>=a;var o=r._.duration/n,d=(r._.width+t.width)/o,u=r._.width,m=r._.width-d*h;return"ltr"===s&&(u=-i.width,m=t.width+d*h,d=-d),!(u<m+t.width)}for(let r=0;r<a;r++)if(u(o[r],t,e,n,s,i)){d=r;break}if(-1===d)return-1;o[d]={time:i.media?t.time:t._utc,width:t.width,height:t.height};return"bottom"===s?h-(d+1)*r:d*r}var h="undefined"!=typeof window&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(t){return setTimeout(t,50/3)},a="undefined"!=typeof window&&(window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame)||clearTimeout;function o(t,i,e){for(var n=0,s=0,r=t.length;s<r-1;)e>=t[n=s+r>>1][i]?s=n:r=n;return t[s]&&e<t[s][i]?s:r}function d(t){return/^(ltr|top|bottom)$/i.test(t)?t.toLowerCase():"rtl"}function u(t){t.ltr=[],t.rtl=[],t.top=[],t.bottom=[]}function m(){if(!this._.visible||!this._.paused)return this;if(this._.paused=!1,this.media)for(var t=0;t<this._.runningList.length;t++){var i=this._.runningList[t];i._utc=Date.now()/1e3-(this.media.currentTime-i.time)}var e=this,n=function(t,i,e,n){return function(){t(this._.stage);var s=Date.now()/1e3,h=this.media?this.media.currentTime:s,a=this.media?this.media.playbackRate:1,o=null,d=0,u=0;for(u=this._.runningList.length-1;u>=0;u--)o=this._.runningList[u],h-(d=this.media?o.time:o._utc)>this._.duration&&(n(this._.stage,o),this._.runningList.splice(u,1));for(var m=[];this._.position<this.comments.length&&(o=this.comments[this._.position],!((d=this.media?o.time:o._utc)>=h));)h-d>this._.duration||(this.media&&(o._utc=s-(this.media.currentTime-o.time)),m.push(o)),++this._.position;for(i(this._.stage,m),u=0;u<m.length;u++)(o=m[u]).y=r.call(this,o),this._.runningList.push(o);for(u=0;u<this._.runningList.length;u++)if(-1!==(o=this._.runningList[u]).y){var c=(this._.width+o.width)*(s-o._utc)*a/this._.duration;"ltr"===o.mode&&(o.x=c-o.width+.5|0),"rtl"===o.mode&&(o.x=this._.width-c+.5|0),"top"!==o.mode&&"bottom"!==o.mode||(o.x=this._.width-o.width>>1),e(this._.stage,o)}}}(this._.engine.framing.bind(this),this._.engine.setup.bind(this),this._.engine.render.bind(this),this._.engine.remove.bind(this));return this._.requestID=h((function t(){n.call(e),e._.requestID=h(t)})),this}function c(){return!this._.visible||this._.paused||(this._.paused=!0,a(this._.requestID),this._.requestID=0),this}function l(){if(!this.media)return this;this.clear(),u(this._.space);var t=o(this.comments,"time",this.media.currentTime);return this._.position=Math.max(0,t-1),this}function f(t){t.play=m.bind(this),t.pause=c.bind(this),t.seeking=l.bind(this),this.media.addEventListener("play",t.play),this.media.addEventListener("pause",t.pause),this.media.addEventListener("playing",t.play),this.media.addEventListener("waiting",t.pause),this.media.addEventListener("seeking",t.seeking)}function p(t){this.media.removeEventListener("play",t.play),this.media.removeEventListener("pause",t.pause),this.media.removeEventListener("playing",t.play),this.media.removeEventListener("waiting",t.pause),this.media.removeEventListener("seeking",t.seeking),t.play=null,t.pause=null,t.seeking=null}function _(t){this._={},this.container=t.container||document.createElement("div"),this.media=t.media,this._.visible=!0,this.engine="canvas",this._.engine=s,this._.requestID=0,this._.speed=Math.max(0,t.speed)||144,this._.duration=4,this.comments=t.comments||[],this.comments.sort((function(t,i){return t.time-i.time}));for(var i=0;i<this.comments.length;i++)this.comments[i].mode=d(this.comments[i].mode);return this._.runningList=[],this._.position=0,this._.paused=!0,this.media&&(this._.listener={},f.call(this,this._.listener)),this._.stage=this._.engine.init(this.container),this._.stage.style.cssText+="position:relative;pointer-events:none;",this.resize(),this.container.appendChild(this._.stage),this._.space={},u(this._.space),this.media&&this.media.paused||(l.call(this),m.call(this)),this}function g(){if(!this.container)return this;for(var t in c.call(this),this.clear(),this.container.removeChild(this._.stage),this.media&&p.call(this,this._.listener),this)Object.prototype.hasOwnProperty.call(this,t)&&(this[t]=null);return this}var v=["mode","time","text","render","style"];function w(t){if(!t||"[object Object]"!==Object.prototype.toString.call(t))return this;for(var i={},e=0;e<v.length;e++)void 0!==t[v[e]]&&(i[v[e]]=t[v[e]]);if(i.text=(i.text||"").toString(),i.mode=d(i.mode),i._utc=Date.now()/1e3,this.media){var n=0;void 0===i.time?(i.time=this.media.currentTime,n=this._.position):(n=o(this.comments,"time",i.time))<this._.position&&(this._.position+=1),this.comments.splice(n,0,i)}else this.comments.push(i);return this}function y(){return this._.visible?this:(this._.visible=!0,this.media&&this.media.paused||(l.call(this),m.call(this)),this)}function b(){return this._.visible?(c.call(this),this.clear(),this._.visible=!1,this):this}function x(){return this._.engine.clear(this._.stage,this._.runningList),this._.runningList=[],this}function L(){return this._.width=this.container.offsetWidth,this._.height=this.container.offsetHeight,this._.engine.resize(this._.stage,this._.width,this._.height),this._.duration=this._.width/this._.speed,this}var T={get:function(){return this._.speed},set:function(t){return"number"!=typeof t||isNaN(t)||!isFinite(t)||t<=0?this._.speed:(this._.speed=t,this._.width&&(this._.duration=this._.width/t),t)}};function k(t){t&&_.call(this,t)}k.prototype.destroy=function(){return g.call(this)},k.prototype.emit=function(t){return w.call(this,t)},k.prototype.show=function(){return y.call(this)},k.prototype.hide=function(){return b.call(this)},k.prototype.clear=function(){return x.call(this)},k.prototype.resize=function(){return L.call(this)},Object.defineProperty(k.prototype,"speed",T);export{k as default};
